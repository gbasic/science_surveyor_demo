<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="stylish.css">
  <script type="text/javascript" src="p5/p5.js"></script>
  <style>
    html, body{
      margin: 0;
      padding: 0;
      background: white;
    }
  </style>
</head>
<script type="text/javascript">

  var fiveOldestTable;
  var rowCount;
  var fiveOldestID = [];
  var fiveOldestName = [];
  var fiveOldestYear = [];
  var fiveOldestIsCited = [];

  var fiveMostCitedTable;
  var fiveMostCitedID = [];
  var fiveMostCitedName = [];
  var fiveMostCitedYear = [];
  var fiveMostCitedIsCited = [];

  var fiveRecentTable;
  var fiveRecentID = [];
  var fiveRecentName = [];
  var fiveRecentYear = [];
  var fiveRecentIsCited = [];

  var margin;
  var leftXmargin;
  var topYListMargin1;
  var topYListMargin2;
  var topYListMargin3;
  var topYSubtitleMargin1;
  var topYSubtitleMargin2;
  var topYSubtitleMargin3;
  var rowHeight;
  var rightXmargin;

  var titleFont;
  var listFont;

  function preload() {
    titleFont = loadFont('fonts/Rubik-Medium.ttf');
    listFont = loadFont ('fonts/Rubik-Regular.ttf');
    fiveOldestTable = loadTable("data/methane_outlier_fiveOldest.txt", "tsv", "header");
    fiveMostCitedTable = loadTable("data/methane_outlier_fiveMostCited.txt", "tsv", "header");
    fiveRecentTable = loadTable("data/methane_outlier_fiveRecent.txt", "tsv", "header");
  }

  function setup() {
    createCanvas(990, 980);
    readData();

    margin = width/30;
    leftXmargin = 0.5 * margin;
    rightXmargin = width - 0.5 * margin;
    rowHeight = 36;
    topYListMargin1 = 3.5 * margin;
    topYListMargin2 = topYListMargin1 * 2 + 5 * rowHeight;
    topYListMargin3 = topYListMargin1 * 3 + 10 * rowHeight;
    topYSubtitleMargin1 = 2.7 * margin;
    topYSubtitleMargin2 = topYListMargin1 + 5 * rowHeight + topYSubtitleMargin1;
    topYSubtitleMargin3 = topYListMargin1 * 2 + 10 * rowHeight + topYSubtitleMargin1;
  }

  function draw() {
    background(250);

    fill(0);
    noStroke();
    textAlign(CENTER, CENTER);
    textFont(titleFont);
    textSize(21);
    text("Studies You Might Want to See", width / 2, margin);

    // Subtitles
    textSize(14);
    text("Five most cited studies in the context:", width / 2, topYSubtitleMargin1);
        text("Five most cited studies in recent years:", width / 2, topYSubtitleMargin2);
    text("Five oldest studies in the context:", width / 2, topYSubtitleMargin3);


    textAlign(LEFT, BOTTOM);
    textFont(listFont);
    fill(255, 35, 35);
    text("Cited studies are in red", margin, height - margin);

    for (var i = 0; i <= 5; i++) {
      dottedLine(leftXmargin, rightXmargin, topYListMargin1 + i * rowHeight);
      dottedLine(leftXmargin, rightXmargin, topYListMargin2 + i * rowHeight);
      dottedLine(leftXmargin, rightXmargin, topYListMargin3 + i * rowHeight);
    }

    // Lists
    textFont(listFont);
    fill(0);
    noStroke();
    for (var i = 0; i < 5; i++) {
      textAlign(LEFT, CENTER);
      text(fiveMostCitedName[i], margin, topYListMargin1 + rowHeight/2 + i * rowHeight);
      text(fiveRecentName[i], margin, topYListMargin2 + rowHeight/2 + i * rowHeight);
      text(fiveOldestName[i], margin, topYListMargin3 + rowHeight/2 + i * rowHeight);
      textAlign(RIGHT, CENTER);
      text(fiveMostCitedYear[i], width - margin, topYListMargin1 + rowHeight/2 + i * rowHeight);
      text(fiveOldestYear[i], width - margin, topYListMargin3 + rowHeight/2 + i * rowHeight);
      text(fiveRecentYear[i], width - margin, topYListMargin2 + rowHeight/2 + i * rowHeight);
    }
  }

  function dottedLine(x1, x2, y) {
    for (var i = 0; i <= 150; i++) {
      var x = lerp(x1, x2, i / 150);
      stroke(0, 200);
      noFill();
      strokeWeight(1);
      strokeCap(ROUND);
      point(x, y);
    }
  }

  function readData() {
    rowCount = fiveOldestTable.getRowCount();
    // for (var i = 0; i < rowCount; i++) {
      fiveOldestID = fiveOldestTable.getColumn("#Columns: article key");
      fiveOldestName = fiveOldestTable.getColumn("title");
      fiveOldestYear = fiveOldestTable.getColumn("year");
      fiveMostCitedID = fiveMostCitedTable.getColumn("#Columns: article key");
      fiveMostCitedName = fiveMostCitedTable.getColumn("title");
      fiveMostCitedYear = fiveMostCitedTable.getColumn("year");
      fiveRecentID = fiveRecentTable.getColumn("#Columns: article key");
      fiveRecentName = fiveRecentTable.getColumn("title");
      fiveRecentYear = fiveRecentTable.getColumn("year");
    // }
  }


</script>